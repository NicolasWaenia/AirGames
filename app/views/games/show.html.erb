<!-- app/views/articles/_form.html.erb -->
<div class="game-description">
  <div class="photo">
  <% if @game.photo.attached? %>
<%= cl_image_tag @game.photo.key, height: 250, width: 250, crop: :fill %>
<% end %><br>
  </div>
  <div class="description">
  <span id= "title">🃏 <%=  @game.name.upcase %> | <%= @game.user.first_name %> à {faire la migration pour récup une ville 😊} </span><br>
  Description: <%= @game.description %><br>
<%= @game.price %>€ per day<br>
Category: <%= @game.category %><br>
Minimum Players: <%= @game.number_of_players_min %><br>
Maximum Players: <%= @game.number_of_players_max %><br>
<% if @game.user === current_user %>
<%= link_to "Edit my game", edit_game_path, class: "btn btn-primary" %>
<% end %>
  </div>

<%# ici, la réservation //Jennifer 👩 %>

</div>




<% if @game.user === current_user %>
  <% bookings = @game.bookings.where(status: ["pending", "accepted"]).where("start_at >= ?", Time.now.midnight) %>
  <% bookings.each do |booking| %>
    <div class="card-product">
      <% if booking.status === "pending" %>
        <%= link_to "Accept", booking_accept_path(booking), data: { turbo_method: :patch } %>
        <%= link_to "Refuse", booking_refuse_path(booking), data: { turbo_method: :patch } %>
      <% end %>
      <h2>From <%= booking.start_at.strftime("%d/%m/%Y")  %> to <%= booking.end_at.strftime("%d/%m/%Y")  %></h2>
      <p><%= booking.user.email %></p>
    </div>
  <% end %>
<% else %>
  <%= simple_form_for [@game, @booking] do |f| %>
    <%= f.input :start_at,
            as: :string,
            input_html: { data: { controller: "datepicker"} } %>
    <%= f.input :end_at,
            as: :string,
            input_html: { data: { controller: "datepicker" } } %>
    <%= f.submit %>
  <% end %>
<% end %>


<%= link_to "Delete this game", game_path(@game), data: { turbo_method: :delete, turbo_confirm: "Are your sure?" } %>
<%= link_to "Back to home", games_path %>
